# PIPA 준수 체크리스트 (개인정보 보호법)

## 1. 개요

본 문서는 환자안전사고 보고 시스템의 개인정보보호법(PIPA) 준수 현황을 기록합니다.

- **시스템명:** Patient Safety Incident Reporting System
- **운영 범위:** 한국 요양병원 내부 QI 시스템
- **문서 버전:** 1.0
- **최종 수정:** 2026-01-19

---

## 2. 데이터 수집 범위

### 2.1 수집 항목

| 카테고리 | 항목 | 필수 여부 | 보관 기간 |
|----------|------|-----------|-----------|
| **사고 정보** | 사고 유형, 등급, 발생일시, 장소 | 필수 | 5년 |
| **사고 정보** | 즉시 조치 내용 | 필수 | 5년 |
| **사고 정보** | 원인 분석, 개선 사항 | 선택 | 5년 |
| **보고자 정보** | 보고자 이름 | 조건부 필수* | 5년 |
| **환자 정보** | 환자 식별 정보 (암호화) | 필수 | 5년 |
| **승인 정보** | 승인자 ID, 승인일시, 코멘트 | 자동 | 5년 |
| **첨부파일** | 증거 자료 (이미지, 문서) | 선택 | 5년 |

*보고자 이름: NEAR_MISS 등급일 때만 선택, 그 외 필수

### 2.2 수집 근거

- 의료법 제12조 (의료기관 인증)
- 환자안전법 제14조 (환자안전사고 보고)
- 개인정보보호법 제15조 (개인정보 수집·이용)

---

## 3. 암호화 정책

### 3.1 저장 시 암호화 (At-Rest)

| 데이터 | 암호화 방식 | 키 관리 |
|--------|-------------|---------|
| 환자 정보 | AES-256-GCM | 환경 변수 (DB_ENCRYPTION_KEY) |
| 사용자 비밀번호 | Argon2id | N/A (해시) |
| 세션 토큰 | JWT (HS256) | 환경 변수 (SECRET_KEY) |

### 3.2 전송 시 암호화 (In-Transit)

- **프로토콜:** HTTPS/TLS 1.3
- **인증서:** Let's Encrypt (프로덕션)

### 3.3 구현 현황

```python
# backend/app/models/incident.py
patient_info = Column(EncryptedType(Text, key=settings.DB_ENCRYPTION_KEY))

# backend/app/security/password.py
ph = PasswordHasher()  # Argon2id
```

- [x] 환자 정보 암호화 (AES-256)
- [x] 비밀번호 해싱 (Argon2id)
- [ ] TLS 설정 (프로덕션 배포 시)

---

## 4. 접근 제어 정책

### 4.1 역할 기반 접근 제어 (RBAC)

| 역할 | 권한 | 데이터 접근 범위 |
|------|------|------------------|
| REPORTER | 생성, 자기 사고 조회/수정 | 본인 보고 건만 |
| QPS_STAFF | 조회, L1 승인, 부서 관리 | 부서 내 사고 |
| VICE_CHAIR | 전체 조회, L2 승인, 수정 | 전체 사고 |
| DIRECTOR | 전체 권한, L3 승인, 삭제 | 전체 사고 |
| ADMIN | 사용자 관리 | 사용자 정보만 |
| MASTER | 슈퍼유저 | 전체 |

### 4.2 구현 현황

```python
# backend/app/security/rbac.py
ROLE_PERMISSIONS = {
    UserRole.REPORTER: {Permission.VIEW_OWN, Permission.CREATE, Permission.EDIT_OWN},
    UserRole.QPS_STAFF: {Permission.VIEW_DEPARTMENT, Permission.APPROVE_L1, ...},
    ...
}
```

- [x] RBAC 정책 정의
- [ ] 행 레벨 접근 제어 (구현 필요)
- [ ] API 권한 검증 (구현 필요)

---

## 5. 감사 로깅 (Audit Trail)

### 5.1 로깅 대상

| 이벤트 | 기록 항목 | 보관 기간 |
|--------|-----------|-----------|
| 로그인/로그아웃 | 사용자 ID, IP, 시간 | 1년 |
| 데이터 조회 | 사용자 ID, 대상 ID, 시간 | 1년 |
| 데이터 생성/수정 | 사용자 ID, 변경 내용, 시간 | 5년 |
| 데이터 삭제 | 사용자 ID, 대상 ID, 시간 | 5년 |
| 승인/거절 | 승인자 ID, 결정, 시간 | 5년 |

### 5.2 구현 현황

```python
# backend/app/models/audit.py
class AuditLog(Base):
    user_id, action, resource_type, resource_id
    old_value, new_value  # JSON
    ip_address, user_agent
    created_at
```

- [x] AuditLog 모델 정의
- [ ] 감사 미들웨어 구현
- [ ] 조회 로깅 구현

---

## 6. 데이터 보관 및 파기

### 6.1 보관 정책

| 데이터 유형 | 보관 기간 | 근거 |
|-------------|-----------|------|
| 사고 기록 | 5년 | 환자안전법 시행규칙 |
| 승인 기록 | 5년 | 의료법 |
| 감사 로그 | 1년 | 내부 정책 |
| 첨부파일 | 5년 | 증거 보존 |

### 6.2 파기 절차

1. 보관 기간 만료 확인
2. 파기 대상 목록 생성
3. DPO 승인
4. 안전한 삭제 (덮어쓰기 3회)
5. 파기 기록 보관

- [ ] 자동 파기 스케줄러 (미구현)
- [ ] 파기 기록 테이블 (미구현)

---

## 7. 정보주체 권리 보장

### 7.1 권리 목록

| 권리 | 구현 방법 | 상태 |
|------|-----------|------|
| 열람권 | 본인 사고 조회 API | ✅ 설계 완료 |
| 정정권 | 본인 사고 수정 API | ✅ 설계 완료 |
| 삭제권 | DPO 요청 처리 | ❌ 수동 처리 |
| 처리정지권 | DPO 요청 처리 | ❌ 수동 처리 |

### 7.2 에스컬레이션

- **DPO 연락처:** (병원 내 담당자)
- **법무팀 연락처:** (법적 해석 필요 시)

---

## 8. 기술적 보호 조치

### 8.1 보안 설정

| 항목 | 설정 | 상태 |
|------|------|------|
| CORS | localhost 전용 | ✅ |
| CSRF | JWT 토큰 검증 | ✅ 설계 완료 |
| SQL Injection | SQLAlchemy ORM | ✅ |
| XSS | React 자동 이스케이프 | ✅ |
| Rate Limiting | 미설정 | ❌ |

### 8.2 보안 스캔

| 도구 | 용도 | 실행 주기 |
|------|------|-----------|
| Bandit | Python SAST | PR마다 |
| pip-audit | Python SCA | PR마다 |
| Semgrep | 다중 언어 SAST | 주간 |
| Gitleaks | 시크릿 스캔 | PR마다 |

---

## 9. 체크리스트 요약

### 필수 항목

- [x] 수집 항목 정의
- [x] 수집 근거 확보
- [x] 암호화 정책 수립
- [x] RBAC 정책 정의
- [x] 감사 로그 모델 정의
- [x] 보관 정책 수립
- [ ] 행 레벨 접근 제어 구현
- [ ] 감사 미들웨어 구현
- [ ] TLS 설정 (프로덕션)
- [ ] 자동 파기 기능

### Release Gate 충족 여부

**상태:** ✅ 문서 완료 (구현 진행 중)

---

## 10. 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 1.0 | 2026-01-19 | 최초 작성 | Claude |

---

## 참고 문서

- 개인정보보호법 (법률 제19234호)
- 환자안전법 (법률 제17787호)
- CLAUDE.md (프로젝트 규칙)
